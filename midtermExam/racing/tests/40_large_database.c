#include "basic_testing.h"
#include "../racing.h"


TEST (large_database_1) {
    CHECK_CMP(racing_init("./tests/large_database_1.data"),==,30000);
    CHECK_CMP(count_cars(0, 0, 0, 0, 0),==,10000);
    CHECK_CMP(count_cars("model 35", "maker 9", 0, 0, 0),==,17);
    CHECK_CMP(count_cars("model 31", "maker 9", 0, 0, 0),==,21);
    CHECK_CMP(count_cars("model 28", "maker 2", 0, 0, 0),==,23);
    CHECK_CMP(count_cars("model 28", "maker 2", 0, 0, 0),==,23);
    CHECK_CMP(count_cars("model 2", "maker 0", 0, 0, 0),==,24);
    CHECK_CMP(count_cars("model 1", "maker 5", 0, 0, 0),==,29);
    CHECK_CMP(count_cars("model 25", 0, 0, 0, 0),==,257);
    CHECK_CMP(count_cars("model 31", "maker 1", 0, 0, 0),==,34);
    CHECK_CMP(count_cars("model 5", "maker 0", 0, 0, 0),==,29);
    CHECK_CMP(count_cars("model 39", "maker 6", 0, 0, 0),==,24);
    CHECK_CMP(count_cars("model 15", "maker 4", 0, 0, 0),==,31);
    CHECK_CMP(count_cars("model 28", "maker 7", 0, 0, 0),==,24);
    CHECK_CMP(count_cars("model 31", "maker 1", 0, 0, 0),==,34);
    CHECK_CMP(count_cars("model 33", "maker 9", 0, 0, 0),==,29);
    CHECK_CMP(count_cars("model 28", "maker 6", 0, 0, 0),==,34);
    CHECK_CMP(count_cars("model 27", "maker 2", 0, 0, 0),==,28);
    CHECK_CMP(count_cars("model 27", "maker 7", 0, 0, 0),==,25);
    CHECK_CMP(count_cars(0, "maker 1", 0, 0, 0),==,1008);
    CHECK_CMP(count_cars("model 11", "maker 5", 0, 0, 0),==,32);
    CHECK_CMP(count_cars("model 2", "maker 0", 0, 0, 0),==,24);
    CHECK_CMP(count_cars("model 15", "maker 6", 0, 0, 0),==,27);
    CHECK_CMP(count_cars("model 2", "maker 8", 0, 0, 0),==,27);
    CHECK_CMP(count_cars("model 33", 0, 0, 0, 0),==,268);
    CHECK_CMP(count_cars("model 10", "maker 7", 0, 0, 0),==,27);
    CHECK_CMP(count_cars("model 3", "maker 2", 0, 0, 0),==,21);
    CHECK_CMP(count_cars("model 39", "maker 9", 0, 0, 0),==,29);
    CHECK_CMP(count_cars("model 31", "maker 3", 0, 0, 0),==,20);
    CHECK_CMP(count_cars("model 26", "maker 8", 0, 0, 0),==,21);
    CHECK_CMP(count_cars("model 1", "maker 2", 0, 0, 0),==,39);
    CHECK_CMP(count_cars("model 0", "maker 0", 0, 0, 0),==,23);
    CHECK_CMP(count_cars("model 7", "maker 6", 0, 0, 0),==,28);
    CHECK_CMP(count_cars("model 15", 0, 0, 0, 0),==,265);
    CHECK_CMP(count_cars("model 8", "maker 0", 0, 0, 0),==,25);
    CHECK_CMP(count_cars("model 34", "maker 1", 0, 0, 0),==,19);
    CHECK_CMP(count_cars(0, "maker 6", 0, 0, 0),==,1066);
    CHECK_CMP(count_cars("model 17", 0, 0, 0, 0),==,272);
    CHECK_CMP(count_cars("model 1", "maker 5", 0, 0, 0),==,29);
    CHECK_CMP(count_cars("model 34", 0, 0, 0, 0),==,254);
    CHECK_CMP(count_cars("model 33", "maker 9", 0, 0, 0),==,29);
    CHECK_CMP(count_cars("model 15", "maker 1", 0, 0, 0),==,32);
    CHECK_CMP(count_cars("model 4", "maker 7", 0, 0, 0),==,30);
    CHECK_CMP(count_cars("model 30", "maker 2", 0, 0, 0),==,22);
    CHECK_CMP(count_cars("model 29", "maker 7", 0, 0, 0),==,14);
    CHECK_CMP(count_cars("model 14", "maker 8", 0, 0, 0),==,30);
    CHECK_CMP(count_cars("model 32", "maker 1", 0, 0, 0),==,29);
    CHECK_CMP(count_cars("model 20", 0, 0, 0, 0),==,238);
    CHECK_CMP(count_cars("model 27", "maker 6", 0, 0, 0),==,35);
    CHECK_CMP(count_cars("model 16", "maker 3", 0, 0, 0),==,18);
    CHECK_CMP(count_cars("model 39", "maker 1", 0, 0, 0),==,31);
    CHECK_CMP(count_cars("model 38", "maker 2", 0, 0, 0),==,31);
    CHECK_CMP(count_cars("model 23", "maker 7", 0, 0, 0),==,15);
    CHECK_CMP(count_cars("model 39", "maker 4", 0, 0, 0),==,24);
    CHECK_CMP(count_cars("model 24", 0, 0, 0, 0),==,250);
    CHECK_CMP(count_cars("model 18", "maker 9", 0, 0, 0),==,26);
    CHECK_CMP(count_cars("model 1", "maker 0", 0, 0, 0),==,20);
    CHECK_CMP(count_cars("model 36", "maker 8", 0, 0, 0),==,23);
    CHECK_CMP(count_cars("model 28", "maker 0", 0, 0, 0),==,24);
    CHECK_CMP(count_cars("model 6", "maker 2", 0, 0, 0),==,24);
    CHECK_CMP(count_cars("model 4", 0, 0, 0, 0),==,239);
    CHECK_CMP(count_cars("model 17", "maker 8", 0, 0, 0),==,18);
    CHECK_CMP(count_cars("model 17", 0, 0, 0, 0),==,272);
    CHECK_CMP(count_cars("model 37", "maker 2", 0, 0, 0),==,27);
    CHECK_CMP(count_cars("model 25", "maker 9", 0, 0, 0),==,24);
    CHECK_CMP(count_cars("model 39", "maker 4", 0, 0, 0),==,24);
    CHECK_CMP(count_cars("model 0", "maker 6", 0, 0, 0),==,25);
    CHECK_CMP(count_cars("model 33", "maker 4", 0, 0, 0),==,30);
    CHECK_CMP(count_cars("model 7", "maker 4", 0, 0, 0),==,27);
    CHECK_CMP(count_cars("model 28", "maker 6", 0, 0, 0),==,34);
    CHECK_CMP(count_cars("model 1", "maker 6", 0, 0, 0),==,14);
    CHECK_CMP(count_drivers("driver 9", "team 8546"),==,0);
    CHECK_CMP(count_drivers("driver 24", "team 7434"),==,0);
    CHECK_CMP(count_drivers("driver 24", "team 10886"),==,0);
    CHECK_CMP(count_drivers("driver 22", "team 3344"),==,0);
    CHECK_CMP(count_drivers("driver 29", "team 429"),==,0);
    CHECK_CMP(count_drivers("driver 4", "team 10684"),==,0);
    CHECK_CMP(count_drivers("driver 26", "team 6318"),==,0);
    CHECK_CMP(count_drivers("driver 18", "team 890"),==,0);
    CHECK_CMP(count_drivers("driver 20", "team 3490"),==,0);
    CHECK_CMP(count_drivers("driver 6", "team 5832"),==,0);
    CHECK_CMP(count_drivers("driver 26", "team 3029"),==,0);
    CHECK_CMP(count_drivers("driver 22", "team 6210"),==,0);
    CHECK_CMP(count_drivers("driver 26", "team 1606"),==,0);
    CHECK_CMP(count_drivers("driver 11", "team 5660"),==,1);
    CHECK_CMP(count_drivers("driver 5", "team 10705"),==,0);
    CHECK_CMP(get_teams(),==,10000);
    racing_delete();
    TEST_PASSED;
}

TEST (large_database_2) {
    CHECK_CMP(racing_init("./tests/large_database_2.data"),==,30000);
    CHECK_CMP(count_cars(0, 0, 0, 0, 0),==,10000);
    CHECK_CMP(count_cars("model 25", "maker 8", 0, 0, 0),==,18);
    CHECK_CMP(count_cars("model 23", "maker 4", 0, 0, 0),==,19);
    CHECK_CMP(count_cars("model 14", "maker 2", 0, 0, 0),==,25);
    CHECK_CMP(count_cars("model 22", "maker 7", 0, 0, 0),==,19);
    CHECK_CMP(count_cars("model 21", "maker 9", 0, 0, 0),==,26);
    CHECK_CMP(count_cars("model 0", "maker 3", 0, 0, 0),==,28);
    CHECK_CMP(count_cars("model 37", "maker 1", 0, 0, 0),==,31);
    CHECK_CMP(count_cars("model 16", "maker 0", 0, 0, 0),==,38);
    CHECK_CMP(count_cars("model 22", "maker 7", 0, 0, 0),==,19);
    CHECK_CMP(count_cars("model 4", "maker 0", 0, 0, 0),==,25);
    CHECK_CMP(count_cars("model 2", "maker 2", 0, 0, 0),==,25);
    CHECK_CMP(count_cars("model 2", "maker 7", 0, 0, 0),==,30);
    CHECK_CMP(count_cars("model 4", "maker 5", 0, 0, 0),==,37);
    CHECK_CMP(count_cars("model 4", "maker 1", 0, 0, 0),==,28);
    CHECK_CMP(count_cars("model 23", "maker 5", 0, 0, 0),==,23);
    CHECK_CMP(count_cars("model 35", 0, 0, 0, 0),==,250);
    CHECK_CMP(count_cars("model 12", "maker 8", 0, 0, 0),==,23);
    CHECK_CMP(count_cars("model 20", "maker 8", 0, 0, 0),==,22);
    CHECK_CMP(count_cars("model 35", "maker 1", 0, 0, 0),==,26);
    CHECK_CMP(count_cars("model 37", "maker 6", 0, 0, 0),==,34);
    CHECK_CMP(count_cars("model 18", "maker 3", 0, 0, 0),==,26);
    CHECK_CMP(count_cars("model 13", 0, 0, 0, 0),==,259);
    CHECK_CMP(count_cars("model 18", "maker 7", 0, 0, 0),==,42);
    CHECK_CMP(count_cars("model 23", "maker 1", 0, 0, 0),==,20);
    CHECK_CMP(count_cars("model 31", 0, 0, 0, 0),==,244);
    CHECK_CMP(count_cars("model 9", "maker 6", 0, 0, 0),==,17);
    CHECK_CMP(count_cars("model 21", 0, 0, 0, 0),==,250);
    CHECK_CMP(count_cars("model 3", "maker 3", 0, 0, 0),==,30);
    CHECK_CMP(count_cars("model 39", "maker 1", 0, 0, 0),==,23);
    CHECK_CMP(count_cars("model 28", "maker 4", 0, 0, 0),==,31);
    CHECK_CMP(count_cars("model 9", "maker 1", 0, 0, 0),==,23);
    CHECK_CMP(count_cars("model 14", "maker 9", 0, 0, 0),==,29);
    CHECK_CMP(count_cars("model 1", "maker 8", 0, 0, 0),==,13);
    CHECK_CMP(count_cars("model 35", 0, 0, 0, 0),==,250);
    CHECK_CMP(count_cars("model 19", 0, 0, 0, 0),==,265);
    CHECK_CMP(count_cars("model 26", "maker 6", 0, 0, 0),==,23);
    CHECK_CMP(count_cars("model 4", 0, 0, 0, 0),==,251);
    CHECK_CMP(count_cars("model 16", "maker 1", 0, 0, 0),==,31);
    CHECK_CMP(count_cars("model 11", "maker 8", 0, 0, 0),==,27);
    CHECK_CMP(count_cars("model 31", "maker 3", 0, 0, 0),==,29);
    CHECK_CMP(count_cars("model 22", "maker 9", 0, 0, 0),==,17);
    CHECK_CMP(count_cars("model 13", 0, 0, 0, 0),==,259);
    CHECK_CMP(count_cars("model 5", "maker 4", 0, 0, 0),==,24);
    CHECK_CMP(count_cars("model 12", "maker 9", 0, 0, 0),==,25);
    CHECK_CMP(count_cars("model 25", "maker 2", 0, 0, 0),==,27);
    CHECK_CMP(count_cars("model 37", "maker 9", 0, 0, 0),==,28);
    CHECK_CMP(count_cars("model 36", "maker 7", 0, 0, 0),==,41);
    CHECK_CMP(count_cars("model 23", "maker 7", 0, 0, 0),==,25);
    CHECK_CMP(count_cars("model 25", "maker 1", 0, 0, 0),==,26);
    CHECK_CMP(count_cars("model 15", "maker 6", 0, 0, 0),==,26);
    CHECK_CMP(count_cars("model 17", "maker 4", 0, 0, 0),==,22);
    CHECK_CMP(count_cars("model 23", "maker 8", 0, 0, 0),==,26);
    CHECK_CMP(count_cars("model 6", "maker 2", 0, 0, 0),==,22);
    CHECK_CMP(count_cars("model 35", "maker 7", 0, 0, 0),==,26);
    CHECK_CMP(count_cars("model 28", "maker 8", 0, 0, 0),==,31);
    CHECK_CMP(count_cars("model 28", "maker 3", 0, 0, 0),==,23);
    CHECK_CMP(count_cars("model 9", "maker 4", 0, 0, 0),==,25);
    CHECK_CMP(count_cars("model 9", "maker 6", 0, 0, 0),==,17);
    CHECK_CMP(count_cars("model 34", "maker 7", 0, 0, 0),==,21);
    CHECK_CMP(count_cars("model 35", "maker 6", 0, 0, 0),==,30);
    CHECK_CMP(count_cars("model 18", "maker 9", 0, 0, 0),==,27);
    CHECK_CMP(count_cars("model 30", "maker 6", 0, 0, 0),==,40);
    CHECK_CMP(count_cars(0, "maker 2", 0, 0, 0),==,944);
    CHECK_CMP(count_cars("model 8", "maker 3", 0, 0, 0),==,26);
    CHECK_CMP(count_cars("model 6", "maker 5", 0, 0, 0),==,31);
    CHECK_CMP(count_cars("model 30", "maker 3", 0, 0, 0),==,30);
    CHECK_CMP(count_cars("model 15", "maker 4", 0, 0, 0),==,19);
    CHECK_CMP(count_cars("model 18", "maker 5", 0, 0, 0),==,18);
    CHECK_CMP(count_cars("model 2", "maker 9", 0, 0, 0),==,24);
    CHECK_CMP(count_drivers(0, 0),==,10000);
    CHECK_CMP(count_drivers("driver 22", "team 459"),==,0);
    CHECK_CMP(count_drivers(0, "team 4141"),==,2);
    CHECK_CMP(count_drivers("driver 0", "team 4575"),==,0);
    CHECK_CMP(count_drivers("driver 21", "team 168"),==,0);
    CHECK_CMP(count_drivers("driver 24", "team 3179"),==,0);
    CHECK_CMP(count_drivers("driver 6", "team 7999"),==,0);
    CHECK_CMP(count_drivers("driver 17", "team 5206"),==,0);
    CHECK_CMP(count_drivers("driver 21", "team 2947"),==,0);
    CHECK_CMP(count_drivers("driver 18", "team 2808"),==,0);
    CHECK_CMP(count_drivers("driver 9", "team 5921"),==,0);
    CHECK_CMP(count_drivers("driver 21", "team 1478"),==,1);
    CHECK_CMP(count_drivers("driver 26", "team 462"),==,0);
    CHECK_CMP(count_drivers("driver 13", "team 7965"),==,0);
    CHECK_CMP(count_drivers("driver 21", "team 3569"),==,0);
    CHECK_CMP(count_drivers("driver 27", "team 10255"),==,0);
    CHECK_CMP(get_teams(),==,10000);
    racing_delete();
    TEST_PASSED;
}

TEST (large_database_3) {
    CHECK_CMP(racing_init("./tests/large_database_3.data"),==,30000);
    CHECK_CMP(count_cars(0, 0, 0, 0, 0),==,10000);
    CHECK_CMP(count_cars("model 18", "maker 1", 0, 0, 0),==,19);
    CHECK_CMP(count_cars("model 19", "maker 3", 0, 0, 0),==,25);
    CHECK_CMP(count_cars("model 20", "maker 1", 0, 0, 0),==,22);
    CHECK_CMP(count_cars("model 33", "maker 1", 0, 0, 0),==,33);
    CHECK_CMP(count_cars(0, "maker 1", 0, 0, 0),==,1024);
    CHECK_CMP(count_cars("model 27", "maker 8", 0, 0, 0),==,18);
    CHECK_CMP(count_cars("model 17", "maker 5", 0, 0, 0),==,25);
    CHECK_CMP(count_cars("model 32", "maker 0", 0, 0, 0),==,29);
    CHECK_CMP(count_cars("model 23", 0, 0, 0, 0),==,287);
    CHECK_CMP(count_cars("model 32", "maker 3", 0, 0, 0),==,23);
    CHECK_CMP(count_cars("model 19", "maker 7", 0, 0, 0),==,21);
    CHECK_CMP(count_cars("model 33", "maker 0", 0, 0, 0),==,30);
    CHECK_CMP(count_cars("model 18", "maker 2", 0, 0, 0),==,16);
    CHECK_CMP(count_cars("model 12", "maker 0", 0, 0, 0),==,21);
    CHECK_CMP(count_cars("model 10", "maker 8", 0, 0, 0),==,16);
    CHECK_CMP(count_cars("model 37", "maker 0", 0, 0, 0),==,20);
    CHECK_CMP(count_cars("model 27", "maker 6", 0, 0, 0),==,33);
    CHECK_CMP(count_cars("model 8", "maker 8", 0, 0, 0),==,21);
    CHECK_CMP(count_cars("model 33", "maker 2", 0, 0, 0),==,29);
    CHECK_CMP(count_cars("model 16", 0, 0, 0, 0),==,219);
    CHECK_CMP(count_cars("model 33", "maker 3", 0, 0, 0),==,34);
    CHECK_CMP(count_cars("model 13", "maker 9", 0, 0, 0),==,23);
    CHECK_CMP(count_cars("model 17", "maker 9", 0, 0, 0),==,25);
    CHECK_CMP(count_cars("model 35", "maker 1", 0, 0, 0),==,28);
    CHECK_CMP(count_cars("model 39", "maker 2", 0, 0, 0),==,11);
    CHECK_CMP(count_cars("model 32", "maker 8", 0, 0, 0),==,25);
    CHECK_CMP(count_cars("model 21", "maker 1", 0, 0, 0),==,18);
    CHECK_CMP(count_cars("model 31", "maker 1", 0, 0, 0),==,19);
    CHECK_CMP(count_cars("model 4", "maker 6", 0, 0, 0),==,24);
    CHECK_CMP(count_cars("model 34", "maker 0", 0, 0, 0),==,27);
    CHECK_CMP(count_cars("model 36", "maker 6", 0, 0, 0),==,18);
    CHECK_CMP(count_cars("model 34", 0, 0, 0, 0),==,239);
    CHECK_CMP(count_cars("model 14", "maker 6", 0, 0, 0),==,25);
    CHECK_CMP(count_cars("model 38", "maker 7", 0, 0, 0),==,19);
    CHECK_CMP(count_cars("model 21", "maker 1", 0, 0, 0),==,18);
    CHECK_CMP(count_cars("model 38", "maker 9", 0, 0, 0),==,25);
    CHECK_CMP(count_cars("model 15", "maker 6", 0, 0, 0),==,22);
    CHECK_CMP(count_cars(0, "maker 1", 0, 0, 0),==,1024);
    CHECK_CMP(count_cars("model 16", "maker 2", 0, 0, 0),==,23);
    CHECK_CMP(count_cars("model 2", "maker 3", 0, 0, 0),==,25);
    CHECK_CMP(count_cars("model 25", "maker 0", 0, 0, 0),==,31);
    CHECK_CMP(count_cars("model 22", "maker 2", 0, 0, 0),==,19);
    CHECK_CMP(count_cars("model 16", "maker 1", 0, 0, 0),==,12);
    CHECK_CMP(count_cars("model 24", "maker 4", 0, 0, 0),==,20);
    CHECK_CMP(count_cars("model 20", "maker 2", 0, 0, 0),==,25);
    CHECK_CMP(count_cars("model 38", "maker 8", 0, 0, 0),==,24);
    CHECK_CMP(count_cars("model 30", "maker 3", 0, 0, 0),==,23);
    CHECK_CMP(count_cars("model 0", "maker 1", 0, 0, 0),==,21);
    CHECK_CMP(count_cars("model 30", "maker 1", 0, 0, 0),==,30);
    CHECK_CMP(count_cars("model 35", "maker 9", 0, 0, 0),==,27);
    CHECK_CMP(count_cars("model 24", "maker 7", 0, 0, 0),==,23);
    CHECK_CMP(count_cars("model 6", "maker 5", 0, 0, 0),==,30);
    CHECK_CMP(count_cars("model 30", "maker 7", 0, 0, 0),==,18);
    CHECK_CMP(count_cars("model 12", "maker 7", 0, 0, 0),==,20);
    CHECK_CMP(count_cars("model 26", 0, 0, 0, 0),==,236);
    CHECK_CMP(count_cars("model 21", "maker 9", 0, 0, 0),==,21);
    CHECK_CMP(count_cars(0, "maker 7", 0, 0, 0),==,932);
    CHECK_CMP(count_cars("model 0", "maker 6", 0, 0, 0),==,21);
    CHECK_CMP(count_cars("model 39", "maker 3", 0, 0, 0),==,30);
    CHECK_CMP(count_cars("model 14", "maker 4", 0, 0, 0),==,26);
    CHECK_CMP(count_cars("model 37", "maker 0", 0, 0, 0),==,20);
    CHECK_CMP(count_cars("model 24", "maker 4", 0, 0, 0),==,20);
    CHECK_CMP(count_cars("model 19", "maker 9", 0, 0, 0),==,24);
    CHECK_CMP(count_cars("model 6", "maker 2", 0, 0, 0),==,24);
    CHECK_CMP(count_cars("model 20", "maker 4", 0, 0, 0),==,28);
    CHECK_CMP(count_cars("model 1", "maker 9", 0, 0, 0),==,16);
    CHECK_CMP(count_cars("model 6", "maker 2", 0, 0, 0),==,24);
    CHECK_CMP(count_cars("model 12", "maker 4", 0, 0, 0),==,28);
    CHECK_CMP(count_cars("model 6", "maker 2", 0, 0, 0),==,24);
    CHECK_CMP(count_drivers(0, 0),==,10000);
    CHECK_CMP(count_drivers("driver 11", "team 8482"),==,0);
    CHECK_CMP(count_drivers("driver 15", "team 9383"),==,0);
    CHECK_CMP(count_drivers("driver 10", "team 4937"),==,0);
    CHECK_CMP(count_drivers("driver 27", "team 1120"),==,0);
    CHECK_CMP(count_drivers("driver 5", "team 4407"),==,0);
    CHECK_CMP(count_drivers("driver 0", "team 2055"),==,1);
    CHECK_CMP(count_drivers("driver 25", "team 8782"),==,0);
    CHECK_CMP(count_drivers(0, "team 4146"),==,0);
    CHECK_CMP(count_drivers("driver 15", "team 2221"),==,0);
    CHECK_CMP(count_drivers("driver 0", "team 3418"),==,0);
    CHECK_CMP(count_drivers("driver 23", "team 6122"),==,0);
    CHECK_CMP(count_drivers("driver 15", "team 1924"),==,0);
    CHECK_CMP(count_drivers("driver 9", "team 5334"),==,0);
    CHECK_CMP(count_drivers("driver 11", "team 4853"),==,0);
    CHECK_CMP(count_drivers("driver 5", "team 342"),==,0);
    CHECK_CMP(get_teams(),==,10000);
    racing_delete();
    TEST_PASSED;
}


MAIN_TEST_DRIVER (large_database_1, large_database_2, large_database_3);
